<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ficha de Personagem</title>
  
  <link rel="stylesheet" href="CSS/style.css" />
  <link rel="stylesheet" href="CSS/esquerdaCS.css">
  <link rel="stylesheet" href="CSS/direitaCS.css">
  <link rel="stylesheet" href="CSS/meioCS.css">
  <link rel="stylesheet" href="CSS/headerCS.css">

  <style>
    /* CSS DO AVISO CUSTOMIZADO */
    .custom-toast-warning {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #1a1a1a;
        color: #fff;
        border: 1px solid #9c27b0;
        border-radius: 6px;
        padding: 15px 20px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.8);
        z-index: 200000; /* Acima de tudo, inclusive do login */
        min-width: 300px;
        max-width: 90%;
        text-align: center;
        font-family: sans-serif;
        font-size: 14px;
        overflow: hidden;
        animation: toastSlideDown 0.3s ease-out forwards;
    }
    .toast-progress {
        position: absolute;
        top: 0;
        left: 0;
        height: 4px;
        background-color: #9c27b0;
        width: 100%;
        transition: width 5s linear;
    }
    @keyframes toastSlideDown {
        from { top: -100px; opacity: 0; }
        to { top: 20px; opacity: 1; }
    }
    @keyframes toastFadeOut {
        from { opacity: 1; transform: translateX(-50%) scale(1); }
        to { opacity: 0; transform: translateX(-50%) scale(0.9); }
    }
  </style>
</head>
<body>
  <header>
    <nav class="navbar">
      <div class="nav-links">
        <a href="#" class="active">Personagens</a>
      </div>
      <img src="img/perfil.png" alt="perfil" class="perfil-img" />
    </nav>
  </header>

  <section class="info-personagem">
    <div class="info-esquerda">
      <img src="img/personagem.png" alt="Foto do personagem" class="foto-personagem" />
    </div>
    <div class="info-direita">
      <div class="linha-info">
        <div class="campo">
          <label>PERSONAGEM</label>
          <input type="text" id="input-personagem" placeholder="" />
        </div>
        <div class="campo">
          <label>JOGADOR</label>
          <input type="text" id="input-jogador" placeholder="" />
        </div>
      </div>
      <div class="linha-info">
        <div class="campo">
          <label>ANTECEDENTE</label>
          <div id="btn-antecedente" class="input-simulado" tabindex="0">Escolher...</div>
        </div>
        <div class="campo">
          <label>CLASSE'S</label>
          <textarea id="input-classesHeader" class="header-textarea" rows="1" readonly></textarea>
        </div>
        <div class="campo">
          <label>RAÇA</label>
          <textarea id="input-raca" class="header-textarea" rows="1"></textarea>
        </div>
      </div>
    </div>
  </section>

  <main class="container">
    <section class="lado-esquerdo">
      <div class="atributos">
        <div class="atributos-header">
          <h3>Atributos</h3>
        </div>
        <div class="hexagrama">
          <img src="img/atributos.png" alt="Atributos" class="hex-overlay" />
          <span class="editar-hex">✏️</span>
          <div class="num n1">0</div>
          <div class="num n2">0</div>
          <div class="num n3">0</div>
          <div class="num n4">0</div>
          <div class="num n5">0</div>
          <div class="num n6">0</div>
        </div>

        <div class="ficha-compacta">
          <div class="controls-inline">
            <div class="control-group">
              <div class="inspiracao-box" title="Inspiração">
                <button id="inspiraLeft">◀</button>
                <span id="inspiraValor">0</span>
                <button id="inspiraRight">▶</button>
              </div>
              <div class="control-label">Inspiração</div>
            </div>
            <div class="control-group">
              <div class="proficiencia-box" title="Proficiência">
                <span>Prof.</span>
                <span id="proficienciaValor">0</span>
              </div>
              <div class="control-label">Proficiência</div>
            </div>
          </div>

          <div class="linha linha-top">
            <div class="nivel-destaque">
              <div class="nivel-titulo">NÍVEL</div>
              <div id="nivelFoco" class="nivel-valor">0</div>
            </div>
            <div class="classe-focus" id="classeFocus">
              <div>
                <div class="classe-nome" id="classeFocusNome">—</div>
                <div class="classe-nivel" id="classeFocusNivel">0</div>
              </div>
              <button class="classe-btn">Classes</button>
            </div>
          </div>

          <div class="linha linha-xp">
            <div class="xp-box">
              <div class="xp-top">
                <div style="display:flex;gap:8px;align-items:center;">
                  <span class="xp-label">XP</span>
                  <input id="xpAtual" type="number" min="0" value="0" class="xp-atual-input" />
                  <span id="xpTotalText" class="xp-total-text">/ 0</span>
                </div>
              </div>
              <div class="xp-bar-outer">
                <div class="xp-bar-inner" id="xpBar"></div>
              </div>
            </div>
            <div class="marco-box">
              <label>Marco</label>
              <div style="display:flex;gap:6px;align-items:center;">
                <input id="marcoAtual" type="number" min="0" value="0" class="marco-input" />
                <input id="marcoMax" type="number" readonly class="marco-input marco-max" />
              </div>
              <div class="marco-bar-outer">
                <div id="marcoBar" class="marco-bar-inner"></div>
              </div>
            </div>
          </div>

          <div class="linha linha-metros">
            <div class="metros-box">
              <label>Metros (m)</label>
              <input type="number" id="metros" min="0" value="0" />
            </div>
            <div class="quadrados-box">
              <label>Quadrados (q)</label>
              <input type="number" id="quadrados" min="0" step="1" />
            </div>
          </div>

          <div class="vida-container">
            <h3 id="btnVida">VIDA</h3>
            <div class="vida-bar">
              <div class="vida-fill" id="vida-fill"></div>
              <div class="vida-text">
                <button class="vida-btn menos5">«</button>
                <button class="vida-btn menos1"><</button>
                <span id="vida-atual">0</span>/<span id="vida-total">0</span>
                <button class="vida-btn mais1">></button>
                <button class="vida-btn mais5">»</button>
              </div>
            </div>
            <div class="classes-lista-container" style="display:none; margin-top:8px;">
              <ul id="classesLista" style="list-style:none; padding:0; margin:0;"></ul>
            </div>
          </div>

          <div class="barras-secundarias">
            <div class="barra-secundaria">
              <h3>VIDA TEMPORÁRIA</h3>
              <div class="vida-bar">
                <div class="vida-fill" id="vida-temp-fill"></div>
                <div class="vida-text">
                  <button class="vida-btn menos5">«</button>
                  <button class="vida-btn menos1"><</button>
                  <span id="vida-temp-atual" contenteditable="true">0</span>
                  <button class="vida-btn mais1">></button>
                  <button class="vida-btn mais5">»</button>
                </div>
              </div>
            </div>
            <div class="barra-secundaria">
              <h3>DANO NECRÓTICO</h3>
              <div class="vida-bar">
                <div class="vida-fill" id="dano-necro-fill" style="background-color: purple;"></div>
                <div class="vida-text">
                  <button class="vida-btn menos5">«</button>
                  <button class="vida-btn menos1"><</button>
                  <span id="dano-necro-atual" contenteditable="true">0</span>
                  <button class="vida-btn mais1">></button>
                  <button class="vida-btn mais5">»</button>
                </div>
              </div>
            </div>
          </div>

          <div class="armadura-area">
            <div class="armadura-card">
              <div class="armadura-grid">
                <div class="escudo-col">
                  <div class="escudo-wrap">
                    <img src="img/escudoArmad.png" alt="escudo" class="escudo-img" />
                    <div class="armadura-valor" id="armaduraValor">12</div>
                  </div>
                  <div class="iniciativa-block">
                    <div class="iniciativa-label">INICIATIVA</div>
                    <div class="iniciativa-valor" id="iniciativaValor">0</div>
                  </div>
                  <div class="bonus-iniciativa-block">
                    <span class="bonus-label">BÔNUS</span>
                    <input type="number" id="iniciativaBonus" class="bonus-valor" value="0" />
                  </div>
                </div>
                <div class="formula-col">
                  <div class="armadura-titulo">CLASSE DE ARMADURA</div>
                  <div class="inline-formula">
                    <span class="formula-eq">=</span>
                    <span class="formula-text">10</span>
                    <span class="formula-plus">+</span>
                    <span class="formula-attr">Dex</span>
                    <span class="formula-plus">+</span>
                    <div class="zero-pair"><span class="zero-num">0</span><span class="zero-label">Equip.</span></div>
                    <span class="formula-plus">+</span>
                    <div class="zero-pair"><span class="zero-num" id="ac-outros" contenteditable="true">0</span><span class="zero-label">Outros.</span></div>
                  </div>
                </div>
                <div class="tipo-col">
                  <div class="tipo-titulo">Tipo de armadura</div>
                  <div class="armadura-tag pesado">Pesado</div>
                </div>
              </div>
              <div class="armadura-details">
                <div class="linha-detail"><div class="label-detail">FRAQUEZA</div><div id="sel-fraquezas" class="input-detail"></div></div>
                <div class="linha-detail"><div class="label-detail">RESISTÊNCIAS</div><div id="sel-resistencias" class="input-detail"></div></div>
                <div class="linha-detail"><div class="label-detail">IMUNIDADE</div><div id="sel-imunidades" class="input-detail"></div></div>
                <div class="linha-detail"><div class="label-detail">PROFICIÊNCIAS</div><div id="sel-proficiencias" class="input-detail"></div></div>
                <div class="linha-detail"><div class="label-detail">IDIOMAS</div><div id="sel-idiomas" class="input-detail"></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="lado-centro">
      <h3>Perícias</h3>
      <ul class="pericias"></ul>
    </section>

    <section class="lado-direito">
      <div class="abas">
        <button class="ativa">Combate</button>
        <button>Mag. Preparadas</button> 
        <button>Habilidades</button>  
        <button>Inventário</button>
        <button>Magias</button>
        <button>Descrição</button>
      </div>
      <div class="conteudo"><p>Você ainda não possui ataques</p></div>
    </section>
  </main>

  <div id="painelClasses" class="painel-classes" aria-hidden="true">
    <div class="painel-inner">
      <div class="painel-header"><h4>Classes</h4><button id="fecharPainel">✖</button></div>
      <div id="listaClasses" class="lista-classes"></div>
    </div>
  </div>

  <div id="login-overlay" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:100000; display:flex; align-items:center; justify-content:center; font-family: sans-serif;">
    <div style="background:#1a1a1a; padding:40px; border-radius:12px; border:2px solid #9c27b0; text-align:center; width:320px;">
        <img src="img/personagem.png" style="width:80px; margin-bottom:20px; border-radius:50%; border:2px solid #9c27b0;">
        <h2 style="color:#fff; margin-bottom:25px; letter-spacing:1px;">ACESSO À FICHA</h2>
        <input type="text" id="login-nome" placeholder="Nome do Personagem" style="width:100%; padding:12px; margin-bottom:15px; background:#000; color:#fff; border:1px solid #333; border-radius:4px;">
        <input type="password" id="login-senha" placeholder="Senha Secreta" style="width:100%; padding:12px; margin-bottom:25px; background:#000; color:#fff; border:1px solid #333; border-radius:4px;">
        <button onclick="tentarLogin()" style="background:#9c27b0; color:#fff; border:none; padding:12px; cursor:pointer; font-weight:bold; width:100%; border-radius:4px;">ENTRAR NA AVENTURA</button>
    </div>
  </div>

  <script src="JS/DireitaJS.js"></script>
  <script src="JS/EsquerdaJS.js"></script>
  <script src="JS/MeioJS.js"></script>
  <script src="JS/HeaderJS.js"></script>
  <script src="JS/MagicSystem.js"></script> 

  <script>
    /* FUNÇÃO DE AVISO CUSTOMIZADO */
    /* FUNÇÃO DE AVISO CUSTOMIZADO CORRIGIDA */
function exibirAvisoTemporario(mensagem) {
    const existente = document.querySelector('.custom-toast-warning');
    if (existente) existente.remove();

    const toast = document.createElement('div');
    toast.className = 'custom-toast-warning';
    
    // Criamos a barra de progresso
    const progress = document.createElement('div');
    progress.className = 'toast-progress';
    
    // Criamos o container do texto
    const content = document.createElement('div');
    content.className = 'toast-content';
    
    // Substituímos as quebras de linha de forma segura
    const textoFormatado = mensagem.split('\n').join('<br>');
    
    content.innerHTML = '<strong style="color:#e0aaff; display:block; margin-bottom:4px; font-size:11px; letter-spacing:1px;">SISTEMA</strong>' + textoFormatado;

    toast.appendChild(progress);
    toast.appendChild(content);
    document.body.appendChild(toast);

    // Inicia a animação da barra
    setTimeout(() => {
        progress.style.width = '0%';
    }, 50);

    // Remove após 5 segundos
    setTimeout(() => {
        if (toast.parentElement) {
            toast.style.animation = 'toastFadeOut 0.5s ease-out forwards';
            setTimeout(() => toast.remove(), 450);
        }
    }, 5000);
}

    /* SUBSTITUI O ALERT PADRÃO DO NAVEGADOR */
    window.alert = function(msg) {
        exibirAvisoTemporario(msg);
    };

    function tentarLogin() {
        const nome = document.getElementById('login-nome').value;
        const senha = document.getElementById('login-senha').value;
        if(nome && senha) {
            carregarDadosIniciais(nome, senha);
        } else {
            exibirAvisoTemporario("Preencha todos os campos!");
        }
    }
  </script>
</body>
</html>